#!/usr/bin/env bash

# get_pipelines.shã®å®Ÿè¡Œã‚’ãƒˆãƒ¬ãƒ¼ã‚¹ã—ã¦è©³ç´°ãªæ™‚é–“ã‚’æ¸¬å®š

set -euo pipefail

echo "ðŸ” get_pipelines.shå®Ÿè¡Œãƒˆãƒ¬ãƒ¼ã‚¹"
echo "============================================================================================================"

# bashã®xtraceæ©Ÿèƒ½ã‚’ä½¿ã£ã¦å®Ÿè¡Œã‚’ãƒˆãƒ¬ãƒ¼ã‚¹
echo "å®Ÿè¡Œé–‹å§‹æ™‚åˆ»: $(date)"
echo

# æ™‚é–“æ¸¬å®šä»˜ãã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ
echo "ðŸ“Š è©³ç´°å®Ÿè¡Œãƒ­ã‚°:"
time bash -x ./get_pipelines.sh -q 2>&1 | while IFS= read -r line; do
    echo "[$(date '+%H:%M:%S.%3N')] $line"
done

echo
echo "å®Ÿè¡Œçµ‚äº†æ™‚åˆ»: $(date)"